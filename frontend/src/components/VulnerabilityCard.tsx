import { useState } from "react";
import { SeverityBadge } from "./SeverityBadge";

interface Props {
  vulnerability: any;
}

export const VulnerabilityCard = ({ vulnerability }: Props) => {
  const [tab, setTab] =
    useState<"attacker" | "defender" | "payload" | "impact">(
      "attacker"
    );

  return (
    <div className="border rounded p-4 bg-white shadow">
      <div className="flex justify-between mb-2">
        <h3 className="font-semibold">{vulnerability.name}</h3>
        <SeverityBadge severity={vulnerability.severity} />
      </div>

      <p className="text-sm text-gray-600 mb-3">
        {vulnerability.description}
      </p>

      <div className="flex gap-2 mb-4">
        {["attacker", "defender", "payload", "impact"].map(
          (t) => (
            <button
              key={t}
              onClick={() => setTab(t as any)}
              className={`px-2 py-1 text-sm rounded ${
                tab === t
                  ? "bg-blue-600 text-white"
                  : "bg-gray-200"
              }`}
            >
              {t}
            </button>
          )
        )}
      </div>

      {tab === "attacker" && (
        <pre className="text-sm bg-red-50 p-3 rounded">
          {vulnerability.attackerLogic || "N/A"}
        </pre>
      )}

      {tab === "defender" && (
        <pre className="text-sm bg-blue-50 p-3 rounded">
          {vulnerability.secureCodeFix || "N/A"}
        </pre>
      )}

      {tab === "payload" && (
        <pre className="text-sm bg-yellow-50 p-3 rounded">
          {vulnerability.simulatedPayload || "N/A"}
        </pre>
      )}

      {tab === "impact" && (
        <div className="text-sm space-y-2">
          <p>
            <strong>Technical:</strong>{" "}
            {vulnerability.impact?.technical || "N/A"}
          </p>
          <p>
            <strong>Business:</strong>{" "}
            {vulnerability.impact?.business || "N/A"}
          </p>
        </div>
      )}
    </div>
  );
};
